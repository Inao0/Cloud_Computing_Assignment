#Test Data

 `./test_data` contain a few csv files containing fake taxi rides values to test this spark application.  

## test_data_1.csv

Corresponding Data :
```
Route(lat,long) dropoff_time
(1,1)(1,300)    2013-01-01 00:10:00
(1,1)(300,1)    2013-01-01 00:15:00
(1,1)(1,300)    2013-01-01 00:15:00
(1,1)(300,1)    2013-01-01 00:16:00
(1,1)(300,1)    2013-01-01 00:17:00
(1,1)(1,300)    2013-01-01 00:20:00
(1,1)(1,300)    2013-01-01 00:25:00
(1,1)(300,1)    2013-01-01 00:25:00
```

This file tests :
- Sliding window feature (count and latest dropoff values per routes)
- Ranking routes in a sliding window according to count and latest dropoff date (different counts, same counts and different latest_dropoff, same counts and latest_dropoff)
- That we get `[((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]` when there is not enough active routes in a window to fill the top N


For a top 3 with a sliding window of size 30 minutes with a 1 minute slide we get (after sorting and by using Query1_Stateful_Streaming) :
```
TimeWindow -                                 Update-time :                      [Route:Count,latest_dropoff]                    [Route:Count,latest_dropoff],...    
(2012-12-31 23:41:00.0,2013-01-01 00:11:00.0)-2020-02-08 17:28:25.699 :         [((1,1),(1,300)) : 1,2013-01-01 00:10:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:42:00.0,2013-01-01 00:12:00.0)-2020-02-08 17:28:22.838 :         [((1,1),(1,300)) : 1,2013-01-01 00:10:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:43:00.0,2013-01-01 00:13:00.0)-2020-02-08 17:28:25.278 :         [((1,1),(1,300)) : 1,2013-01-01 00:10:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:44:00.0,2013-01-01 00:14:00.0)-2020-02-08 17:28:25.748 :         [((1,1),(1,300)) : 1,2013-01-01 00:10:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:45:00.0,2013-01-01 00:15:00.0)-2020-02-08 17:28:24.698 :         [((1,1),(1,300)) : 1,2013-01-01 00:10:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:46:00.0,2013-01-01 00:16:00.0)-2020-02-08 17:28:22.924 :         [((1,1),(1,300)) : 2,2013-01-01 00:15:00.0]     [((1,1),(300,1)) : 1,2013-01-01 00:15:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:47:00.0,2013-01-01 00:17:00.0)-2020-02-08 17:28:24.455 :         [((1,1),(300,1)) : 2,2013-01-01 00:16:00.0]     [((1,1),(1,300)) : 2,2013-01-01 00:15:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:48:00.0,2013-01-01 00:18:00.0)-2020-02-08 17:28:23.219 :         [((1,1),(300,1)) : 3,2013-01-01 00:17:00.0]     [((1,1),(1,300)) : 2,2013-01-01 00:15:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:49:00.0,2013-01-01 00:19:00.0)-2020-02-08 17:28:23.802 :         [((1,1),(300,1)) : 3,2013-01-01 00:17:00.0]     [((1,1),(1,300)) : 2,2013-01-01 00:15:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:50:00.0,2013-01-01 00:20:00.0)-2020-02-08 17:28:24.632 :         [((1,1),(300,1)) : 3,2013-01-01 00:17:00.0]     [((1,1),(1,300)) : 2,2013-01-01 00:15:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:51:00.0,2013-01-01 00:21:00.0)-2020-02-08 17:28:25.703 :         [((1,1),(1,300)) : 3,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 3,2013-01-01 00:17:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:52:00.0,2013-01-01 00:22:00.0)-2020-02-08 17:28:25.704 :         [((1,1),(1,300)) : 3,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 3,2013-01-01 00:17:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:53:00.0,2013-01-01 00:23:00.0)-2020-02-08 17:28:23.473 :         [((1,1),(1,300)) : 3,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 3,2013-01-01 00:17:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:54:00.0,2013-01-01 00:24:00.0)-2020-02-08 17:28:26.734 :         [((1,1),(1,300)) : 3,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 3,2013-01-01 00:17:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:55:00.0,2013-01-01 00:25:00.0)-2020-02-08 17:28:26.025 :         [((1,1),(1,300)) : 3,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 3,2013-01-01 00:17:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:56:00.0,2013-01-01 00:26:00.0)-2020-02-08 17:28:23.823 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:57:00.0,2013-01-01 00:27:00.0)-2020-02-08 17:28:24.116 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:58:00.0,2013-01-01 00:28:00.0)-2020-02-08 17:28:25.216 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:59:00.0,2013-01-01 00:29:00.0)-2020-02-08 17:28:25.318 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:00:00.0,2013-01-01 00:30:00.0)-2020-02-08 17:28:25.178 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:01:00.0,2013-01-01 00:31:00.0)-2020-02-08 17:28:25.893 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:02:00.0,2013-01-01 00:32:00.0)-2020-02-08 17:28:25.849 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:03:00.0,2013-01-01 00:33:00.0)-2020-02-08 17:28:26.447 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:04:00.0,2013-01-01 00:34:00.0)-2020-02-08 17:28:24.302 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:05:00.0,2013-01-01 00:35:00.0)-2020-02-08 17:28:22.423 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:06:00.0,2013-01-01 00:36:00.0)-2020-02-08 17:28:24.326 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:07:00.0,2013-01-01 00:37:00.0)-2020-02-08 17:28:24.904 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:08:00.0,2013-01-01 00:38:00.0)-2020-02-08 17:28:24.792 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:09:00.0,2013-01-01 00:39:00.0)-2020-02-08 17:28:25.854 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:10:00.0,2013-01-01 00:40:00.0)-2020-02-08 17:28:23.833 :         [((1,1),(1,300)) : 4,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:11:00.0,2013-01-01 00:41:00.0)-2020-02-08 17:28:24.253 :         [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((1,1),(1,300)) : 3,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:12:00.0,2013-01-01 00:42:00.0)-2020-02-08 17:28:22.793 :         [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((1,1),(1,300)) : 3,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:13:00.0,2013-01-01 00:43:00.0)-2020-02-08 17:28:26.055 :         [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((1,1),(1,300)) : 3,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:14:00.0,2013-01-01 00:44:00.0)-2020-02-08 17:28:26.776 :         [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((1,1),(1,300)) : 3,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:15:00.0,2013-01-01 00:45:00.0)-2020-02-08 17:28:24.941 :         [((1,1),(300,1)) : 4,2013-01-01 00:25:00.0]     [((1,1),(1,300)) : 3,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:16:00.0,2013-01-01 00:46:00.0)-2020-02-08 17:28:25.705 :         [((1,1),(300,1)) : 3,2013-01-01 00:25:00.0]     [((1,1),(1,300)) : 2,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:17:00.0,2013-01-01 00:47:00.0)-2020-02-08 17:28:26.308 :         [((1,1),(1,300)) : 2,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:18:00.0,2013-01-01 00:48:00.0)-2020-02-08 17:28:22.126 :         [((1,1),(1,300)) : 2,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 1,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:19:00.0,2013-01-01 00:49:00.0)-2020-02-08 17:28:25.753 :         [((1,1),(1,300)) : 2,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 1,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:20:00.0,2013-01-01 00:50:00.0)-2020-02-08 17:28:23.386 :         [((1,1),(1,300)) : 2,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 1,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:21:00.0,2013-01-01 00:51:00.0)-2020-02-08 17:28:26.2 :           [((1,1),(1,300)) : 1,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 1,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:22:00.0,2013-01-01 00:52:00.0)-2020-02-08 17:28:26.081 :         [((1,1),(1,300)) : 1,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 1,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:23:00.0,2013-01-01 00:53:00.0)-2020-02-08 17:28:23.415 :         [((1,1),(1,300)) : 1,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 1,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:24:00.0,2013-01-01 00:54:00.0)-2020-02-08 17:28:26.48 :          [((1,1),(1,300)) : 1,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 1,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:25:00.0,2013-01-01 00:55:00.0)-2020-02-08 17:28:22.704 :         [((1,1),(1,300)) : 1,2013-01-01 00:25:00.0]     [((1,1),(300,1)) : 1,2013-01-01 00:25:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] 
```
## test_data_2.csv
   
   Corresponding Data :
   ```
   Route(lat,long) dropoff_time
   (1,1)(1,>300)    2013-01-01 00:10:00
   (1,1)(1,<1)    2013-01-01 00:10:00
   (1,1)(>300,1)    2013-01-01 00:10:00
   (1,1)(<1,1)    2013-01-01 00:10:00
   (1,>300)(1,1)    2013-01-01 00:10:00
   (1,<1)(1,1)    2013-01-01 00:10:00
   (>300,1)(1,1)    2013-01-01 00:10:00
   (<1,1)(1,1)    2013-01-01 00:10:00
   (1,1)(1,1)    2013-01-01 00:10:00
   ```
   
   This file tests :
   - That we filter out every routes that starts or ends outside of the 300x300 grid defined by the DEBS 2015 challenge
   
   In this case we should se only one `(1,1)(1,1)    2013-01-01 00:10:00` 
   For a top 3 with a sliding window of size 30 minutes with a 1 minute slide we indeed get (after sorting and by using Query1_Stateful_Streaming) :
   ``` 
TimeWindow -                                  Update-time :                     [Route,Count,latest_dropoff]                    [Route,Count,latest_dropoff],...  
(2012-12-31 23:41:00.0,2013-01-01 00:11:00.0)-2020-02-08 21:15:16.907 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:42:00.0,2013-01-01 00:12:00.0)-2020-02-08 21:15:13.963 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:43:00.0,2013-01-01 00:13:00.0)-2020-02-08 21:15:16.481 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:44:00.0,2013-01-01 00:14:00.0)-2020-02-08 21:15:16.962 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:45:00.0,2013-01-01 00:15:00.0)-2020-02-08 21:15:15.728 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:46:00.0,2013-01-01 00:16:00.0)-2020-02-08 21:15:14.039 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:47:00.0,2013-01-01 00:17:00.0)-2020-02-08 21:15:15.507 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:48:00.0,2013-01-01 00:18:00.0)-2020-02-08 21:15:14.347 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:49:00.0,2013-01-01 00:19:00.0)-2020-02-08 21:15:14.89 :          [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]
(2012-12-31 23:50:00.0,2013-01-01 00:20:00.0)-2020-02-08 21:15:15.661 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:51:00.0,2013-01-01 00:21:00.0)-2020-02-08 21:15:16.911 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:52:00.0,2013-01-01 00:22:00.0)-2020-02-08 21:15:16.912 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:53:00.0,2013-01-01 00:23:00.0)-2020-02-08 21:15:14.54 :          [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]
(2012-12-31 23:54:00.0,2013-01-01 00:24:00.0)-2020-02-08 21:15:17.855 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:55:00.0,2013-01-01 00:25:00.0)-2020-02-08 21:15:17.225 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:56:00.0,2013-01-01 00:26:00.0)-2020-02-08 21:15:14.916 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:57:00.0,2013-01-01 00:27:00.0)-2020-02-08 21:15:15.165 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:58:00.0,2013-01-01 00:28:00.0)-2020-02-08 21:15:16.414 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2012-12-31 23:59:00.0,2013-01-01 00:29:00.0)-2020-02-08 21:15:16.504 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:00:00.0,2013-01-01 00:30:00.0)-2020-02-08 21:15:16.36 :          [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]
(2013-01-01 00:01:00.0,2013-01-01 00:31:00.0)-2020-02-08 21:15:17.126 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:02:00.0,2013-01-01 00:32:00.0)-2020-02-08 21:15:17.072 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:03:00.0,2013-01-01 00:33:00.0)-2020-02-08 21:15:17.607 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:04:00.0,2013-01-01 00:34:00.0)-2020-02-08 21:15:15.357 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:05:00.0,2013-01-01 00:35:00.0)-2020-02-08 21:15:13.412 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:06:00.0,2013-01-01 00:36:00.0)-2020-02-08 21:15:15.379 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:07:00.0,2013-01-01 00:37:00.0)-2020-02-08 21:15:15.988 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:08:00.0,2013-01-01 00:38:00.0)-2020-02-08 21:15:15.851 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:09:00.0,2013-01-01 00:39:00.0)-2020-02-08 21:15:17.077 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
(2013-01-01 00:10:00.0,2013-01-01 00:40:00.0)-2020-02-08 21:15:14.923 :         [((1,1),(1,1)) : 1,2013-01-01 00:10:00.0]       [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
```
which corresponds to only one  `(1,1)(1,1)    2013-01-01 00:10:00`

## test_data_3.csv and test_data_4.csv 
   
   Corresponding Data :
 - test_data_3.csv 
``` Route(lat,long) dropoff_time
  (1,1)(1,300)    2013-01-01 00:10:00
  (1,1)(1,300)    2013-01-01 00:11:00
  (1,1)(1,300)    2013-01-01 00:10:30
  (1,1)(1,300)    2013-01-01 00:11:15
  (1,1)(1,300)    2013-01-01 00:12:00
  (1,1)(1,300)    2013-01-01 00:20:00
  (1,1)(300,1)    2013-01-01 00:9:00
  (1,1)(300,1)    2013-01-01 00:10:00
```
- test_data_4.csv
``` Route(lat,long) dropoff_time
  (1,1)(1,300)    2013-01-01 00:19:30
  (1,1)(1,300)    2013-01-01 00:20:00
  (1,1)(300,1)    2013-01-01 00:9:00  d
  (1,1)(300,1)    2013-01-01 00:10:00 d
  (1,1)(300,1)    1970-01-01 01:16:40 d

```   
   These files are meant to test the Watermark applied on the query. Only the 3rd file should be in the folder monitored 
   by spark at the beginning of the processing. Once this file is processed the 4th one should be added in the same folder
   without restarting the application.
   They include values for testing :
   - values slightly out of order but that fits in the watermark delay.
   - late values that don't fit in the watermark delay but in the same file as some values early enough that are in the 
   same window
   - late values that don't fit in the watermark delay but some values early enough for the same sliding window are 
   processed in another file
   - late values that don't fit in the watermark delay with no other data as old as them.
 
According to https://spark.apache.org/docs/latest/structured-streaming-programming-guide.html#handling-late-data-and-watermarking :
>**Semantic Guarantees of Aggregation with Watermarking**
>
> A watermark delay (set with withWatermark) of “2 hours” guarantees that the engine will never drop any data that is less than 2 hours delayed. In other words, any data less than 2 hours behind (in terms of event-time) the latest data processed till then is guaranteed to be aggregated.
>
>However, the guarantee is strict only in one direction. Data delayed by more than 2 hours is not guaranteed to be dropped; it may or may not get aggregated. More delayed is the data, less likely is the engine going to process it.

   For a top 3 with a sliding window of size 30 minutes with a 1 minute slide and a 1 minute watermark on the dropoff 
    time, if we sort the results lines by time window, we indeed get :
    
 ```
    TimeWindow -                                  Update-time :                     [Route:Count,latest_dropoff]                    [Route:Count,latest_dropoff],...
    (2012-12-31 23:40:00.0,2013-01-01 00:10:00.0)-2020-02-08 22:07:32.151 :         [((1,1),(300,1)) : 1,2013-01-01 00:09:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:41:00.0,2013-01-01 00:11:00.0)-2020-02-08 22:07:33.959 :         [((1,1),(1,300)) : 2,2013-01-01 00:10:30.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:42:00.0,2013-01-01 00:12:00.0)-2020-02-08 22:07:30.875 :         [((1,1),(1,300)) : 4,2013-01-01 00:11:15.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:43:00.0,2013-01-01 00:13:00.0)-2020-02-08 22:07:33.576 :         [((1,1),(1,300)) : 5,2013-01-01 00:12:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:44:00.0,2013-01-01 00:14:00.0)-2020-02-08 22:07:34.009 :         [((1,1),(1,300)) : 5,2013-01-01 00:12:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:45:00.0,2013-01-01 00:15:00.0)-2020-02-08 22:07:32.902 :         [((1,1),(1,300)) : 5,2013-01-01 00:12:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:46:00.0,2013-01-01 00:16:00.0)-2020-02-08 22:07:30.965 :         [((1,1),(1,300)) : 5,2013-01-01 00:12:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:47:00.0,2013-01-01 00:17:00.0)-2020-02-08 22:07:32.666 :         [((1,1),(1,300)) : 5,2013-01-01 00:12:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:48:00.0,2013-01-01 00:18:00.0)-2020-02-08 22:07:31.346 :         [((1,1),(1,300)) : 5,2013-01-01 00:12:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:49:00.0,2013-01-01 00:19:00.0)-2020-02-08 22:07:32.017 :         [((1,1),(1,300)) : 5,2013-01-01 00:12:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:50:00.0,2013-01-01 00:20:00.0)-2020-02-08 22:07:32.828 :         [((1,1),(1,300)) : 5,2013-01-01 00:12:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:50:00.0,2013-01-01 00:20:00.0)-2020-02-08 22:07:52.756 :         [((1,1),(1,300)) : 6,2013-01-01 00:19:30.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:51:00.0,2013-01-01 00:21:00.0)-2020-02-08 22:07:33.964 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:51:00.0,2013-01-01 00:21:00.0)-2020-02-08 22:07:53.627 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:52:00.0,2013-01-01 00:22:00.0)-2020-02-08 22:07:33.965 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:52:00.0,2013-01-01 00:22:00.0)-2020-02-08 22:07:53.635 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:53:00.0,2013-01-01 00:23:00.0)-2020-02-08 22:07:31.61 :          [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:53:00.0,2013-01-01 00:23:00.0)-2020-02-08 22:07:51.756 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:54:00.0,2013-01-01 00:24:00.0)-2020-02-08 22:07:35.043 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:54:00.0,2013-01-01 00:24:00.0)-2020-02-08 22:07:54.519 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:55:00.0,2013-01-01 00:25:00.0)-2020-02-08 22:07:34.343 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:55:00.0,2013-01-01 00:25:00.0)-2020-02-08 22:07:53.955 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:56:00.0,2013-01-01 00:26:00.0)-2020-02-08 22:07:32.045 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:56:00.0,2013-01-01 00:26:00.0)-2020-02-08 22:07:52.099 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:57:00.0,2013-01-01 00:27:00.0)-2020-02-08 22:07:32.324 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:57:00.0,2013-01-01 00:27:00.0)-2020-02-08 22:07:52.332 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:58:00.0,2013-01-01 00:28:00.0)-2020-02-08 22:07:33.508 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:58:00.0,2013-01-01 00:28:00.0)-2020-02-08 22:07:53.275 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:59:00.0,2013-01-01 00:29:00.0)-2020-02-08 22:07:33.609 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2012-12-31 23:59:00.0,2013-01-01 00:29:00.0)-2020-02-08 22:07:53.349 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:00:00.0,2013-01-01 00:30:00.0)-2020-02-08 22:07:33.456 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:00:00.0,2013-01-01 00:30:00.0)-2020-02-08 22:07:53.238 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:01:00.0,2013-01-01 00:31:00.0)-2020-02-08 22:07:34.23 :          [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:01:00.0,2013-01-01 00:31:00.0)-2020-02-08 22:07:53.854 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:02:00.0,2013-01-01 00:32:00.0)-2020-02-08 22:07:34.171 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:02:00.0,2013-01-01 00:32:00.0)-2020-02-08 22:07:53.807 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:03:00.0,2013-01-01 00:33:00.0)-2020-02-08 22:07:34.758 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:03:00.0,2013-01-01 00:33:00.0)-2020-02-08 22:07:54.289 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:04:00.0,2013-01-01 00:34:00.0)-2020-02-08 22:07:32.52 :          [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:04:00.0,2013-01-01 00:34:00.0)-2020-02-08 22:07:52.501 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:05:00.0,2013-01-01 00:35:00.0)-2020-02-08 22:07:30.309 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:05:00.0,2013-01-01 00:35:00.0)-2020-02-08 22:07:50.963 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:06:00.0,2013-01-01 00:36:00.0)-2020-02-08 22:07:32.55 :          [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:06:00.0,2013-01-01 00:36:00.0)-2020-02-08 22:07:52.522 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:07:00.0,2013-01-01 00:37:00.0)-2020-02-08 22:07:33.155 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:07:00.0,2013-01-01 00:37:00.0)-2020-02-08 22:07:53.026 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:08:00.0,2013-01-01 00:38:00.0)-2020-02-08 22:07:33.017 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:08:00.0,2013-01-01 00:38:00.0)-2020-02-08 22:07:52.904 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:09:00.0,2013-01-01 00:39:00.0)-2020-02-08 22:07:34.176 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:09:00.0,2013-01-01 00:39:00.0)-2020-02-08 22:07:53.812 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 2,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:10:00.0,2013-01-01 00:40:00.0)-2020-02-08 22:07:32.053 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 1,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:10:00.0,2013-01-01 00:40:00.0)-2020-02-08 22:07:52.105 :         [((1,1),(1,300)) : 8,2013-01-01 00:20:00.0]     [((1,1),(300,1)) : 1,2013-01-01 00:10:00.0]    [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:11:00.0,2013-01-01 00:41:00.0)-2020-02-08 22:07:32.47 :          [((1,1),(1,300)) : 4,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:11:00.0,2013-01-01 00:41:00.0)-2020-02-08 22:07:52.457 :         [((1,1),(1,300)) : 6,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:12:00.0,2013-01-01 00:42:00.0)-2020-02-08 22:07:30.79 :          [((1,1),(1,300)) : 2,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:12:00.0,2013-01-01 00:42:00.0)-2020-02-08 22:07:51.259 :         [((1,1),(1,300)) : 4,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:13:00.0,2013-01-01 00:43:00.0)-2020-02-08 22:07:34.372 :         [((1,1),(1,300)) : 1,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:13:00.0,2013-01-01 00:43:00.0)-2020-02-08 22:07:53.979 :         [((1,1),(1,300)) : 3,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:14:00.0,2013-01-01 00:44:00.0)-2020-02-08 22:07:35.091 :         [((1,1),(1,300)) : 1,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:14:00.0,2013-01-01 00:44:00.0)-2020-02-08 22:07:54.563 :         [((1,1),(1,300)) : 3,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:15:00.0,2013-01-01 00:45:00.0)-2020-02-08 22:07:33.186 :         [((1,1),(1,300)) : 1,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:15:00.0,2013-01-01 00:45:00.0)-2020-02-08 22:07:53.057 :         [((1,1),(1,300)) : 3,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:16:00.0,2013-01-01 00:46:00.0)-2020-02-08 22:07:33.966 :         [((1,1),(1,300)) : 1,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:16:00.0,2013-01-01 00:46:00.0)-2020-02-08 22:07:53.636 :         [((1,1),(1,300)) : 3,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:17:00.0,2013-01-01 00:47:00.0)-2020-02-08 22:07:34.628 :         [((1,1),(1,300)) : 1,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:17:00.0,2013-01-01 00:47:00.0)-2020-02-08 22:07:54.174 :         [((1,1),(1,300)) : 3,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:18:00.0,2013-01-01 00:48:00.0)-2020-02-08 22:07:29.912 :         [((1,1),(1,300)) : 1,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:18:00.0,2013-01-01 00:48:00.0)-2020-02-08 22:07:50.854 :         [((1,1),(1,300)) : 3,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:19:00.0,2013-01-01 00:49:00.0)-2020-02-08 22:07:34.016 :         [((1,1),(1,300)) : 1,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:19:00.0,2013-01-01 00:49:00.0)-2020-02-08 22:07:53.69 :          [((1,1),(1,300)) : 3,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:20:00.0,2013-01-01 00:50:00.0)-2020-02-08 22:07:31.511 :         [((1,1),(1,300)) : 1,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]  
    (2013-01-01 00:20:00.0,2013-01-01 00:50:00.0)-2020-02-08 22:07:51.69 :          [((1,1),(1,300)) : 2,2013-01-01 00:20:00.0]     [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0] [((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]     
```

First We can see that the oldest element of the second file `1970-01-01 01:16:40` was not included. We can also see that
no time-window ending before `2013-01-01 00:20:00` as been updated with data from `test_data_4.csv`.
However we can notice that inside the same file, the order don't seems to matter as for the window 
`(2012-12-31 23:41:00.0,2013-01-01 00:11:00.0)` takes into account all the four events from `test_data_3.csv` happening
between `2013-01-01 00:9:00` and `2013-01-01 00:10:00`, including those that might have been ignore due to the 
watermark if each line of the file was processed in order. This is probably due to the fact that this small file is treated
in parallel as one block and the watermark is probably actually updated after the whole file is processed. At this point 
the latest value that has been processed is from `2013-01-01 00:20:00` therefore it should accept events arriving after
`2013-01-01 00:19:00`.
By looking at time window `(2012-12-31 23:50:00.0,2013-01-01 00:20:00.0)` and `(2012-12-31 23:51:00.0,2013-01-01 00:21:00.0)`
We can see that both event from `test_data_4.csv` that happen after `2013-01-01 00:19:00` are included into the updated
 count values.
Those results indicated that our watermark is working which would allow to handle actual stateful streaming without 
having an ever growing memory to store the states of new timeWindows. Indeed all states referring to windows that are too
old according to the watermark are deleted (and therefore no longer possible to update anymore). 

 

    