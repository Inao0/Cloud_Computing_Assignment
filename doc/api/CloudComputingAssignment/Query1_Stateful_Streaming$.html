<!DOCTYPE html >
<html>
        <head>
          <meta http-equiv="X-UA-Compatible" content="IE=edge" />
          <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
          <title></title>
          <meta name="description" content="" />
          <meta name="keywords" content="" />
          <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
          
      
      <link href="../lib/index.css" media="screen" type="text/css" rel="stylesheet" />
      <link href="../lib/template.css" media="screen" type="text/css" rel="stylesheet" />
      <link href="../lib/diagrams.css" media="screen" type="text/css" rel="stylesheet" id="diagrams-css" />
      <script type="text/javascript" src="../lib/jquery.min.js"></script>
      <script type="text/javascript" src="../lib/jquery.panzoom.min.js"></script>
      <script type="text/javascript" src="../lib/jquery.mousewheel.min.js"></script>
      <script type="text/javascript" src="../lib/index.js"></script>
      <script type="text/javascript" src="../index.js"></script>
      <script type="text/javascript" src="../lib/scheduler.js"></script>
      <script type="text/javascript" src="../lib/template.js"></script>
      
      <script type="text/javascript">
        /* this variable can be used by the JS to determine the path to the root document */
        var toRoot = '../';
      </script>
    
        </head>
        <body>
      <div id="search">
        <span id="doc-title"><span id="doc-version"></span></span>
        <span class="close-results"><span class="left">&lt;</span> Back</span>
        <div id="textfilter">
          <span class="input">
            <input autocapitalize="none" placeholder="Search" id="index-input" type="text" accesskey="/" />
            <i class="clear material-icons"></i>
            <i id="search-icon" class="material-icons"></i>
          </span>
        </div>
    </div>
      <div id="search-results">
        <div id="search-progress">
          <div id="progress-fill"></div>
        </div>
        <div id="results-content">
          <div id="entity-results"></div>
          <div id="member-results"></div>
        </div>
      </div>
      <div id="content-scroll-container" style="-webkit-overflow-scrolling: touch;">
        <div id="content-container" style="-webkit-overflow-scrolling: touch;">
          <div id="subpackage-spacer">
            <div id="packages">
              <h1>Packages</h1>
              <ul>
                <li name="_root_.root" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="_root_"></a><a id="root:_root_"></a>
      <span class="permalink">
      <a href="../index.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a title="" href="../index.html"><span class="name">root</span></a>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd><a href="../index.html" class="extype" name="_root_">root</a></dd></dl></div>
    </li><li name="_root_.CloudComputingAssignment" visbl="pub" class="indented1 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="CloudComputingAssignment"></a><a id="CloudComputingAssignment:CloudComputingAssignment"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/index.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">package</span>
      </span>
      <span class="symbol">
        <a title="Provides classes for solving a problem inspired by the first query of the DEBS 2015 challenge" href="index.html"><span class="name">CloudComputingAssignment</span></a>
      </span>
      
      <p class="shortcomment cmt">Provides classes for solving a problem inspired by the first query of the DEBS 2015 challenge
</p><div class="fullcomment"><div class="comment cmt"><p>Provides classes for solving a problem inspired by the first query of the DEBS 2015 challenge
</p></div><dl class="attributes block"> <dt>Definition Classes</dt><dd><a href="../index.html" class="extype" name="_root_">root</a></dd></dl></div>
    </li><li class="current-entities indented1">
                        <span class="separator"></span>
                        <a class="class" href="CountAndLatestDropoff.html" title="Contains a count and a latest drop-off timestamp Meant to be corresponding to a timeWindow and Route"></a>
                        <a href="CountAndLatestDropoff.html" title="Contains a count and a latest drop-off timestamp Meant to be corresponding to a timeWindow and Route">CountAndLatestDropoff</a>
                      </li><li class="current-entities indented1">
                        <span class="separator"></span>
                        <a class="class" href="NYCTaxiRide.html" title="A processed NewYork City Taxi Ride"></a>
                        <a href="NYCTaxiRide.html" title="A processed NewYork City Taxi Ride">NYCTaxiRide</a>
                      </li><li class="current-entities indented1">
                        <span class="separator"></span>
                        <a class="object" href="Query1_Batch$.html" title="Provides a solution for parsing DEBS 2015 csv data files by using the implemented csv reader"></a>
                        <a href="Query1_Batch$.html" title="Provides a solution for parsing DEBS 2015 csv data files by using the implemented csv reader">Query1_Batch</a>
                      </li><li class="current-entities indented1">
                        <span class="separator"></span>
                        <a class="object" href="Query1_Simple_Dataset$.html" title="Provides a solution for parsing DEBS 2015 csv data files by using the implemented csv reader"></a>
                        <a href="Query1_Simple_Dataset$.html" title="Provides a solution for parsing DEBS 2015 csv data files by using the implemented csv reader">Query1_Simple_Dataset</a>
                      </li><li class="current-entities indented1">
                        <span class="separator"></span>
                        <a class="object" href="" title="Provides a solution for parsing DEBS 2015 csv data files by using stateful streaming"></a>
                        <a href="" title="Provides a solution for parsing DEBS 2015 csv data files by using stateful streaming">Query1_Stateful_Streaming</a>
                      </li><li class="current-entities indented1">
                        <span class="separator"></span>
                        <a class="class" href="RawNYCTaxiRides.html" title="A raw NewYork City taxi ride as found in data files"></a>
                        <a href="RawNYCTaxiRides.html" title="A raw NewYork City taxi ride as found in data files">RawNYCTaxiRides</a>
                      </li><li class="current-entities indented1">
                        <span class="separator"></span>
                        <a class="class" href="RoutesTopNElements.html" title="An element of the Top N of most frequent routes in a given time window"></a>
                        <a href="RoutesTopNElements.html" title="An element of the Top N of most frequent routes in a given time window">RoutesTopNElements</a>
                      </li><li class="current-entities indented1">
                        <span class="separator"></span>
                        <a class="class" href="WindowStateOfTaxiRoutes.html" title="State associated with a time window containing the count of drop-off and the most recent drop-off timestamp for each routes used during the time window"></a>
                        <a href="WindowStateOfTaxiRoutes.html" title="State associated with a time window containing the count of drop-off and the most recent drop-off timestamp for each routes used during the time window">WindowStateOfTaxiRoutes</a>
                      </li><li class="current-entities indented1">
                        <span class="separator"></span>
                        <a class="class" href="WindowTopN.html" title="Top N of the most frequent routes on a given time window"></a>
                        <a href="WindowTopN.html" title="Top N of the most frequent routes on a given time window">WindowTopN</a>
                      </li>
              </ul>
            </div>
          </div>
          <div id="content">
            <body class="object value">
      <div id="definition">
        <div class="big-circle object">o</div>
        <p id="owner"><a href="index.html" class="extype" name="CloudComputingAssignment">CloudComputingAssignment</a></p>
        <h1>Query1_Stateful_Streaming<span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span></h1>
        <h3><span class="morelinks"></span></h3>
      </div>

      <h4 id="signature" class="signature">
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">object</span>
      </span>
      <span class="symbol">
        <span class="name">Query1_Stateful_Streaming</span>
      </span>
      </h4>

      
          <div id="comment" class="fullcommenttop"><div class="comment cmt"><p>Provides a solution for parsing DEBS 2015 csv data files by using stateful streaming</p><p>This implementation handles streaming data
This solution output one row per update and per time window with entire top included</p><p>example output:
TimeWindow -								 Update-time :					[Route:Count,latest_dropoff]				[Route:Count,latest_dropoff],...
(2012-12-31 23:41:00.0,2013-01-01 00:11:00.0)-2020-02-09 05:08:53.821 : 	[((1,1),(1,300)) : 3,2013-01-01 00:10:30.0]	[((1,1),(300,1)) : 3,2013-01-01 00:10:00.0]	[((-1,-1),(-1,-1)) : -1,1970-01-01 01:00:00.0]</p><p>The default output folder is /Result/Stateful-Streaming
</p></div><div class="toggleContainer block">
          <span class="toggle">
            Linear Supertypes
          </span>
          <div class="superTypes hiddenContent"><span class="extype" name="scala.AnyRef">AnyRef</span>, <span class="extype" name="scala.Any">Any</span></div>
        </div></div>
        

      <div id="mbrsel">
        <div class="toggle"></div>
        <div id="memberfilter">
          <i class="material-icons arrow"></i>
          <span class="input">
            <input id="mbrsel-input" placeholder="Filter all members" type="text" accesskey="/" />
          </span>
          <i class="clear material-icons"></i>
        </div>
        <div id="filterby">
          <div id="order">
            <span class="filtertype">Ordering</span>
            <ol>
              
              <li class="alpha in"><span>Alphabetic</span></li>
              <li class="inherit out"><span>By Inheritance</span></li>
            </ol>
          </div>
          <div class="ancestors">
                  <span class="filtertype">Inherited<br />
                  </span>
                  <ol id="linearization">
                    <li class="in" name="CloudComputingAssignment.Query1_Stateful_Streaming"><span>Query1_Stateful_Streaming</span></li><li class="in" name="scala.AnyRef"><span>AnyRef</span></li><li class="in" name="scala.Any"><span>Any</span></li>
                  </ol>
                </div><div class="ancestors">
              <span class="filtertype"></span>
              <ol>
                <li class="hideall out"><span>Hide All</span></li>
                <li class="showall in"><span>Show All</span></li>
              </ol>
            </div>
          <div id="visbl">
              <span class="filtertype">Visibility</span>
              <ol><li class="public in"><span>Public</span></li><li class="all out"><span>All</span></li></ol>
            </div>
        </div>
      </div>

      <div id="template">
        <div id="allMembers">
        

        

        

        <div class="values members">
              <h3>Value Members</h3>
              <ol>
                <li name="scala.AnyRef#!=" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="!=(x$1:Any):Boolean"></a><a id="!=(Any):Boolean"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#!=(x$1:Any):Boolean" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span title="gt4s: $bang$eq" class="name">!=</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Any">Any</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="scala.AnyRef###" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="##():Int"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html###():Int" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span title="gt4s: $hash$hash" class="name">##</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Int">Int</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="scala.AnyRef#==" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="==(x$1:Any):Boolean"></a><a id="==(Any):Boolean"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#==(x$1:Any):Boolean" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span title="gt4s: $eq$eq" class="name">==</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Any">Any</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="CloudComputingAssignment.Query1_Stateful_Streaming#OUTPUT_FOLDER" visbl="pub" class="indented0 " data-isabs="false" fullComment="no" group="Ungrouped">
      <a id="OUTPUT_FOLDER:String"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#OUTPUT_FOLDER:String" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">val</span>
      </span>
      <span class="symbol">
        <span class="name">OUTPUT_FOLDER</span><span class="result">: <span class="extype" name="scala.Predef.String">String</span></span>
      </span>
      
      <p class="shortcomment cmt">Folder for output files
</p>
    </li><li name="scala.Any#asInstanceOf" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="asInstanceOf[T0]:T0"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#asInstanceOf[T0]:T0" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">asInstanceOf</span><span class="tparams">[<span name="T0">T0</span>]</span><span class="result">: <span class="extype" name="scala.Any.asInstanceOf.T0">T0</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>Any</dd></dl></div>
    </li><li name="scala.AnyRef#clone" visbl="prt" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="clone():Object"></a><a id="clone():AnyRef"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#clone():Object" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">clone</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.AnyRef">AnyRef</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Attributes</dt><dd>protected[<span class="extype" name="java.lang">lang</span>] </dd><dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="defval" name="classOf[java.lang.CloneNotSupportedException]">...</span>
    </span>)</span>
              
                <span class="name">@native</span><span class="args">()</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#eq" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="eq(x$1:AnyRef):Boolean"></a><a id="eq(AnyRef):Boolean"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#eq(x$1:AnyRef):Boolean" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">eq</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.AnyRef">AnyRef</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.AnyRef#equals" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="equals(x$1:Any):Boolean"></a><a id="equals(Any):Boolean"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#equals(x$1:Any):Boolean" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">equals</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Any">Any</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="scala.AnyRef#finalize" visbl="prt" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="finalize():Unit"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#finalize():Unit" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">finalize</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Attributes</dt><dd>protected[<span class="extype" name="java.lang">lang</span>] </dd><dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="symbol">classOf[java.lang.Throwable]</span>
    </span>)</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#getClass" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="getClass():Class[_]"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#getClass():Class[_]" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">getClass</span><span class="params">()</span><span class="result">: <span class="extype" name="java.lang.Class">Class</span>[_]</span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd><dt>Annotations</dt><dd>
                <span class="name">@native</span><span class="args">()</span>
              
        </dd></dl></div>
    </li><li name="CloudComputingAssignment.Query1_Stateful_Streaming#getTopN" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="getTopN(windowStateOfTaxiRoutes:CloudComputingAssignment.WindowStateOfTaxiRoutes,n:Int):CloudComputingAssignment.WindowTopN"></a><a id="getTopN(WindowStateOfTaxiRoutes,Int):WindowTopN"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#getTopN(windowStateOfTaxiRoutes:CloudComputingAssignment.WindowStateOfTaxiRoutes,n:Int):CloudComputingAssignment.WindowTopN" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">getTopN</span><span class="params">(<span name="windowStateOfTaxiRoutes">windowStateOfTaxiRoutes: <a href="WindowStateOfTaxiRoutes.html" class="extype" name="CloudComputingAssignment.WindowStateOfTaxiRoutes">WindowStateOfTaxiRoutes</a></span>, <span name="n">n: <span class="extype" name="scala.Int">Int</span></span>)</span><span class="result">: <a href="WindowTopN.html" class="extype" name="CloudComputingAssignment.WindowTopN">WindowTopN</a></span>
      </span>
      
      <p class="shortcomment cmt">Returns the n most frequented Routes for a time window according to the provided windowStateOfTaxiRoutes</p><div class="fullcomment"><div class="comment cmt"><p>Returns the n most frequented Routes for a time window according to the provided windowStateOfTaxiRoutes</p><p>The ranking of the different routes relies on the ordered trait implemented by CountAndLatestDropOff case class.</p><p>If there is not enough routes in windowStateOfTaxiRoutes the remaining spot in the top n are filled with
the following RidesTopNElement : (((-1,-1),(-1,-1)),-1,1970-01-01 01:00:00.0)</p><p>The returned windowTopN last_update is filled with a timestamp corresponding to the current date and time
</p></div><dl class="paramcmts block"><dt class="param">windowStateOfTaxiRoutes</dt><dd class="cmt"><p>WindowStateOfTaxiRoutes summarising the last count and latest drop-off time for each routes in a time window</p></dd><dt class="param">n</dt><dd class="cmt"><p>Number of elements in the final ranking top</p></dd><dt>returns</dt><dd class="cmt"><p>WindowTopN containing the n most frequented routes for the time window</p></dd></dl></div>
    </li><li name="scala.AnyRef#hashCode" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="hashCode():Int"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#hashCode():Int" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">hashCode</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Int">Int</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd><dt>Annotations</dt><dd>
                <span class="name">@native</span><span class="args">()</span>
              
        </dd></dl></div>
    </li><li name="scala.Any#isInstanceOf" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="isInstanceOf[T0]:Boolean"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#isInstanceOf[T0]:Boolean" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">isInstanceOf</span><span class="tparams">[<span name="T0">T0</span>]</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>Any</dd></dl></div>
    </li><li name="CloudComputingAssignment.Query1_Stateful_Streaming#main" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="main(args:Array[String]):Unit"></a><a id="main(Array[String]):Unit"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#main(args:Array[String]):Unit" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">main</span><span class="params">(<span name="args">args: <span class="extype" name="scala.Array">Array</span>[<span class="extype" name="scala.Predef.String">String</span>]</span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      
      <p class="shortcomment cmt">Main program - process DEBS 2015  NYC Taxi rides datafiles to solve a problem inspired by the first query of the challenge</p><div class="fullcomment"><div class="comment cmt"><p>Main program - process DEBS 2015  NYC Taxi rides datafiles to solve a problem inspired by the first query of the challenge</p><p>Loop that is executed when the class name is passed as argument alongside to the jar file to the spark-submit script
See README.md for more information about how to run this application</p></div></div>
    </li><li name="scala.AnyRef#ne" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="ne(x$1:AnyRef):Boolean"></a><a id="ne(AnyRef):Boolean"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#ne(x$1:AnyRef):Boolean" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">ne</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.AnyRef">AnyRef</span></span>)</span><span class="result">: <span class="extype" name="scala.Boolean">Boolean</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.AnyRef#notify" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="notify():Unit"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#notify():Unit" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">notify</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@native</span><span class="args">()</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#notifyAll" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="notifyAll():Unit"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#notifyAll():Unit" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">notifyAll</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@native</span><span class="args">()</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#synchronized" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="synchronized[T0](x$1:=&gt;T0):T0"></a><a id="synchronized[T0](⇒T0):T0"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#synchronized[T0](x$1:=&gt;T0):T0" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">synchronized</span><span class="tparams">[<span name="T0">T0</span>]</span><span class="params">(<span name="arg0">arg0: ⇒ <span class="extype" name="java.lang.AnyRef.synchronized.T0">T0</span></span>)</span><span class="result">: <span class="extype" name="java.lang.AnyRef.synchronized.T0">T0</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd></dl></div>
    </li><li name="scala.AnyRef#toString" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="toString():String"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#toString():String" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">toString</span><span class="params">()</span><span class="result">: <span class="extype" name="java.lang.String">String</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef → Any</dd></dl></div>
    </li><li name="scala.AnyRef#wait" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="wait():Unit"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#wait():Unit" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">wait</span><span class="params">()</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="defval" name="classOf[java.lang.InterruptedException]">...</span>
    </span>)</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#wait" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="wait(x$1:Long,x$2:Int):Unit"></a><a id="wait(Long,Int):Unit"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#wait(x$1:Long,x$2:Int):Unit" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">wait</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Long">Long</span></span>, <span name="arg1">arg1: <span class="extype" name="scala.Int">Int</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="defval" name="classOf[java.lang.InterruptedException]">...</span>
    </span>)</span>
              
        </dd></dl></div>
    </li><li name="scala.AnyRef#wait" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="wait(x$1:Long):Unit"></a><a id="wait(Long):Unit"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#wait(x$1:Long):Unit" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier">final </span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">wait</span><span class="params">(<span name="arg0">arg0: <span class="extype" name="scala.Long">Long</span></span>)</span><span class="result">: <span class="extype" name="scala.Unit">Unit</span></span>
      </span>
      
      <div class="fullcomment"><dl class="attributes block"> <dt>Definition Classes</dt><dd>AnyRef</dd><dt>Annotations</dt><dd>
                <span class="name">@throws</span><span class="args">(<span>
      
      <span class="defval" name="classOf[java.lang.InterruptedException]">...</span>
    </span>)</span>
              
                <span class="name">@native</span><span class="args">()</span>
              
        </dd></dl></div>
    </li><li name="CloudComputingAssignment.Query1_Stateful_Streaming#windowTopNMapping" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="windowTopNMapping(timeWindow:CloudComputingAssignment.MyTimeWindow,values:Iterator[CloudComputingAssignment.NYCTaxiRide],state:org.apache.spark.sql.streaming.GroupState[CloudComputingAssignment.WindowStateOfTaxiRoutes]):Option[CloudComputingAssignment.WindowStateOfTaxiRoutes]"></a><a id="windowTopNMapping(MyTimeWindow,Iterator[NYCTaxiRide],GroupState[WindowStateOfTaxiRoutes]):Option[WindowStateOfTaxiRoutes]"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#windowTopNMapping(timeWindow:CloudComputingAssignment.MyTimeWindow,values:Iterator[CloudComputingAssignment.NYCTaxiRide],state:org.apache.spark.sql.streaming.GroupState[CloudComputingAssignment.WindowStateOfTaxiRoutes]):Option[CloudComputingAssignment.WindowStateOfTaxiRoutes]" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">def</span>
      </span>
      <span class="symbol">
        <span class="name">windowTopNMapping</span><span class="params">(<span name="timeWindow">timeWindow: <a href="index.html#MyTimeWindow=(java.sql.Timestamp,java.sql.Timestamp)" class="extmbr" name="CloudComputingAssignment.MyTimeWindow">MyTimeWindow</a></span>, <span name="values">values: <span class="extype" name="scala.Iterator">Iterator</span>[<a href="NYCTaxiRide.html" class="extype" name="CloudComputingAssignment.NYCTaxiRide">NYCTaxiRide</a>]</span>, <span name="state">state: <span class="extype" name="org.apache.spark.sql.streaming.GroupState">GroupState</span>[<a href="WindowStateOfTaxiRoutes.html" class="extype" name="CloudComputingAssignment.WindowStateOfTaxiRoutes">WindowStateOfTaxiRoutes</a>]</span>)</span><span class="result">: <span class="extype" name="scala.Option">Option</span>[<a href="WindowStateOfTaxiRoutes.html" class="extype" name="CloudComputingAssignment.WindowStateOfTaxiRoutes">WindowStateOfTaxiRoutes</a>]</span>
      </span>
      
      <p class="shortcomment cmt">Processes new taxi Rides corresponding to the window and keeps track of the previous taxi Rides and maps each
timeWindow to an optionnal state containing the updated information
</p><div class="fullcomment"><div class="comment cmt"><p>Processes new taxi Rides corresponding to the window and keeps track of the previous taxi Rides and maps each
timeWindow to an optionnal state containing the updated information
</p></div><dl class="paramcmts block"><dt class="param">timeWindow</dt><dd class="cmt"><p>timeWindow</p></dd><dt class="param">values</dt><dd class="cmt"><p>processed taxi rides corresponding to the window</p></dd><dt class="param">state</dt><dd class="cmt"><p>A WindowStateOfTaxiRoutes state object set by previous invocations of the given function and corresponding
                  to this key window. It contains the list of all the processed taxi rides corresponding to this time window</p></dd><dt>returns</dt><dd class="cmt"><p>optionnal state corresponding to the window</p></dd></dl></div>
    </li><li name="CloudComputingAssignment.Query1_Stateful_Streaming#writerForText" visbl="pub" class="indented0 " data-isabs="false" fullComment="yes" group="Ungrouped">
      <a id="writerForText:org.apache.spark.sql.ForeachWriter[Option[CloudComputingAssignment.WindowStateOfTaxiRoutes]]"></a><a id="writerForText:ForeachWriter[Option[WindowStateOfTaxiRoutes]]"></a>
      <span class="permalink">
      <a href="../CloudComputingAssignment/Query1_Stateful_Streaming$.html#writerForText:org.apache.spark.sql.ForeachWriter[Option[CloudComputingAssignment.WindowStateOfTaxiRoutes]]" title="Permalink">
        <i class="material-icons"></i>
      </a>
    </span>
      <span class="modifier_kind">
        <span class="modifier"></span>
        <span class="kind">val</span>
      </span>
      <span class="symbol">
        <span class="name">writerForText</span><span class="result">: <span class="extype" name="org.apache.spark.sql.ForeachWriter">ForeachWriter</span>[<span class="extype" name="scala.Option">Option</span>[<a href="WindowStateOfTaxiRoutes.html" class="extype" name="CloudComputingAssignment.WindowStateOfTaxiRoutes">WindowStateOfTaxiRoutes</a>]]</span>
      </span>
      
      <p class="shortcomment cmt">writerForText allows us to write the results from the query into a text file</p><div class="fullcomment"><div class="comment cmt"><p>writerForText allows us to write the results from the query into a text file</p><p>This writer process the optionnal state corresponding to a window and compute the corresponding top n if possible
It is then happened to a text file according to the spark partition id
The output results is split between different files in OUPUT_FOLDER according to spark partitioning</p><p>This implementation is inspired by :
https://stackoverflow.com/questions/49026429/how-to-use-update-output-mode-with-fileformat-format</p><h5>Why can't we use a predefine output sink ?</h5><p>According to ForeachWriter documentation this is &quot;A class to consume data generated by a StreamingQuery&quot;
Here we need to define one manually because :
- Queries with mapGroupsWithState support only Update output mode
- File Sink support only	Append mode</p><p>Therefore predefined writers for files won't work :</p><p>We therefore decide to use a Foreach Sink and the define the following ForeachWriter.</p><p>This type of sink is said, according to http://spark.apache.org/docs/latest/structured-streaming-programming-guide.html#output-sinks
to support update mode.
However when running the application as it is we obtain he following error message :</p><p>&quot; Caused by: java.lang.IllegalArgumentException: Data source v2 streaming sinks does not support Update mode.
at org.apache.spark.sql.execution.streaming.StreamExecution.createStreamingWrite(StreamExecution.scala:635)&quot;</p><p>By having a look at spark source code we find where the error is coming from (StreamExecution.scala:628) :
&quot; case Update =&gt;
// Although no v2 sinks really support Update mode now, but during tests we do want them
// to pretend to support Update mode, and  treat Update mode same as Append mode.&quot;
if (Utils.isTesting) {
          writeBuilder.buildForStreaming()
} else {
throw new IllegalArgumentException(
&quot;Data source v2 streaming sinks does not support Update mode.&quot;)
}</p><p>Therefore in order to avoid this else loop that throw this error no mater which type of output sink we use,
we export SPARK_TESTING=$true into the run-time environment to enter the if branch which seems the only way to
get an update mode in the current version of spark
</p></div></div>
    </li>
              </ol>
            </div>

        

        
        </div>

        <div id="inheritedMembers">
        <div class="parent" name="scala.AnyRef">
              <h3>Inherited from <span class="extype" name="scala.AnyRef">AnyRef</span></h3>
            </div><div class="parent" name="scala.Any">
              <h3>Inherited from <span class="extype" name="scala.Any">Any</span></h3>
            </div>
        
        </div>

        <div id="groupedMembers">
        <div class="group" name="Ungrouped">
              <h3>Ungrouped</h3>
              
            </div>
        </div>

      </div>

      <div id="tooltip"></div>

      <div id="footer">  </div>
    </body>
          </div>
        </div>
      </div>
    </body>
      </html>
